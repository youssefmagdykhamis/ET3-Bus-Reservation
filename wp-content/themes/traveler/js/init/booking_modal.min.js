(function(t){function a(a){var e=a+"  .booking-item-payment",r=t(e);r.find(".overlay-form").show(),t.ajax({type:"post",dataType:"json",url:st_params.ajax_url,data:{action:"modal_get_cart_detail"},success:function(t){r.html(t),r.find(".overlay-form").hide()},error:function(t){r.find(".overlay-form").hide()}})}function e(a){if(a.length){var e=a.offset().top;t("#wpadminbar").length&&"fixed"==t("#wpadminbar").css("position")&&(e-=32),e-=300,t("html,body").animate({scrollTop:e},500)}}function r(a,r,i){void 0===i&&(i="infomation");var o='<div class="alert alert-'+i+'">'+r+"</div>";a.length&&(a.html(""),a.html(o),a.offset().top>t(window).height()&&e(a))}function i(t){var a=t.find(".captcha_box");url=a.find(".captcha_img").attr("src"),a.find(".captcha_img").attr("src",url)}var o=!1;t(document).on("click",".btn-st-add-cart",function(){var e=t(this),i=e.closest("form"),n=t(".message_box"),s=i.serialize();s+="&action=st_add_to_cart",e.addClass("loading"),n.html(""),t.ajax({type:"post",dataType:"json",url:st_params.ajax_url,data:s,success:function(i){e.removeClass("loading"),i.message&&r(n,i.message,"danger"),i.status&&(t.magnificPopup.open({items:{type:"inline",src:e.data("target")},close:function(){o=!1}}),a(e.data("target")))},error:function(t){e.removeClass("loading")}})}),t(".btn-st-show-cart-modal").on("click",function(){var e=t(this);t.magnificPopup.open({items:{type:"inline",src:e.data("target")},close:function(){o=!1}}),a(e.data("target"))}),t(document).on("click",".booking_modal_form .btn-st-checkout-submit",function(){var a=t(this).closest("form");a.trigger("st_before_checkout_modal");var e=t('input[name="st_payment_gateway"]:checked',a).val(),r=t('input[name="wait_validate_'+e+'"]',a).val();if("wait"===r)return a.trigger("st_wait_checkout_modal"),!1;a.STSendModalBookingAjax()}),t.fn.STSendModalBookingAjax=function(){this.each(function(){var a=t(this),e=t(".btn-st-checkout-submit",this),r=a.serializeArray();r.push({name:"action",value:"booking_form_direct_submit"}),a.find(".form-control").removeClass("error"),a.find(".form_alert").addClass("hidden");for(var n={},s=!0,d=0;d<r.length;++d)n[r[d].name]=r[d].value;return t("input.required,select.required,textarea.required",a).removeClass("error"),t("input.required,select.required,textarea.required",a).each(function(){t(this).val()||(t(this).addClass("error"),s=!1)}),0==s?(a.find(".form_alert").addClass("alert-danger").removeClass("hidden"),a.find(".form_alert").html(st_checkout_text.validate_form),!1):n.term_condition?(n.order_id=o,e.addClass("loading"),void t.ajax({type:"post",dataType:"json",url:st_params.ajax_url,data:n,success:function(r){e.removeClass("loading"),r.message&&(a.find(".form_alert").addClass("alert-danger").removeClass("hidden"),a.find(".form_alert").html(r.message)),r.redirect&&(window.location.href=r.redirect),r.redirect_form&&t("body").append(r.redirect_form),void 0!==r.order_id&&r.order_id&&(o=r.order_id),r.new_nonce;n.item_id;i(a)},error:function(t){alert("Ajax Fail");n.item_id;i(a),e.removeClass("loading")}})):(a.find(".form_alert").addClass("alert-danger").removeClass("hidden"),a.find(".form_alert").html(st_checkout_text.error_accept_term),!1)})},t(".payment-item-radio").on("ifChecked",function(){var a=t(this).closest("li.payment-gateway");id=a.data("gateway"),a.addClass("active").siblings().removeClass("active"),t('.st-payment-tab-content .st-tab-content[data-id="'+id+'"]').siblings().fadeOut("fast"),t('.st-payment-tab-content .st-tab-content[data-id="'+id+'"]').fadeIn("fast")})})(jQuery);