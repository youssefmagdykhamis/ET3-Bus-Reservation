jQuery(function(a){"use strict";function t(a,t){var e=a.replace(new RegExp(t+"(?!([^<]+)?>)","gi"),'<span class="highlight">$&</span>');return e}var e="";a(".input-daterange .amd_depart_date").each(function(){var t=a(this).closest("form"),s=a(this).parent();a(this);a(this).datepicker({language:st_params.locale,autoclose:!0,todayHighlight:!0,startDate:"today",format:s.data("tp-date-format"),weekStart:1}).on("changeDate",function(e){var n=e.date.getMonth()+1;e.date.getMonth()+1<10&&(n="0"+n);var r=e.date.getDate();e.date.getDate()<10&&(r="0"+r),a(this).parent().find(".amd-date-from").val(e.date.getFullYear()+"-"+n+"-"+r);var i=e.date;i.setDate(i.getDate()+0),a(".input-daterange .amd_return_date",t).datepicker("remove"),a(".input-daterange .amd_return_date",t).datepicker({language:st_params.locale,startDate:"+0d",format:s.data("tp-date-format"),autoclose:!0,todayHighlight:!0,weekStart:1}),a(".input-daterange .amd_return_date",t).datepicker("setDates",i),a(".input-daterange .amd_return_date",t).datepicker("setStartDate",i)}),a(".input-daterange .amd_return_date",t).datepicker({language:st_params.locale,startDate:"+0d",format:s.data("tp-date-format"),autoclose:!0,todayHighlight:!0,weekStart:1}).on("changeDate",function(t){var s=t.date.getMonth()+1;t.date.getMonth()+1<10&&(s="0"+s);var n=t.date.getDate();t.date.getDate()<10&&(n="0"+n),e=t.date.getFullYear()+"-"+s+"-"+n,a(this).parent().find(".amd-date-to").val(e);var r='<i class="fa fa-times tp-icon-return-del"></i>';a(".input-daterange-return .tp-icon-return-del").length&&a(".input-daterange-return .tp-icon-return-del").remove(),a(".input-daterange-return").append(r)})}),a(document).on("click",".tp-icon-return-del",function(){a(".input-daterange .amd_return_date").val(""),a("input.amd-date-to").val(""),a(this).remove()}),a(".amd-form-passengers .amd_group_display").on("click",function(){a(this).parent().find(".amd-form-passengers-class").toggleClass("none"),a(this).find(".fa").toggleClass("fa-chevron-up"),a(this).find(".fa").toggleClass("fa-chevron-down")}),a(document).on("keyup mouseup",".amd-passengers-class input[name=adults]",function(){var t=a(this).closest(".amd-passengers-class");if(""==a(this).val());else{var e=a("input[name=infants]",t).val();""==e&&(e=0);var s=a("input[name=children]",t).val();""==s&&(s=0);var n=parseInt(e)+parseInt(s)+parseInt(a(this).val());if(n>9){var r=9-(parseInt(e)+parseInt(s));a(this).val(r),a(".amd-form-passengers-class .notice").html(a(".amd-form-passengers-class .notice").data("maxup")).fadeIn()}else a(".amd_group_display .quantity-passengers").text(n),a(".amd-form-passengers-class .notice").html("").fadeOut()}}),a(document).on("keyup mouseup",".amd-passengers-class input[name=children]",function(){var t=a(this).closest(".amd-passengers-class");if(""==a(this).val());else{var e=a("input[name=infants]",t).val();""==e&&(e=0);var s=a("input[name=adults]",t).val();""==s&&(s=0);var n=parseInt(e)+parseInt(s)+parseInt(a(this).val());if(n>9){var r=9-(parseInt(e)+parseInt(s));a(this).val(r),a(".amd-form-passengers-class .notice").html(a(".amd-form-passengers-class .notice").data("maxup")).fadeIn()}else a(".amd_group_display .quantity-passengers").text(n),a(".amd-form-passengers-class .notice").html("").fadeOut()}}),a(document).on("keyup mouseup",".amd-passengers-class input[name=infants]",function(){var t=a(this).closest(".amd-passengers-class");if(""==a(this).val());else{var e=a("input[name=adults]",t).val();""==e&&(e=0);var s=a("input[name=children]",t).val();""==s&&(s=0);var n=parseInt(e)+parseInt(s)+parseInt(a(this).val());if(n>9){var r=9-(parseInt(s)+parseInt(e));a(this).val(r),a(".amd-form-passengers-class .notice").html(a(".amd-form-passengers-class .notice").data("maxup")).fadeIn()}else parseInt(a(this).val())>e?(a(this).val(e),a(".amd-form-passengers-class .notice").html(a(".amd-form-passengers-class .notice").data("maxinf")).fadeIn()):(a(".amd_group_display .quantity-passengers").text(n),a(".amd-form-passengers-class .notice").html("").fadeOut())}}),a(document).on("focusout",".amd-passengers-class input[name=adults]",function(){""!=a(this).val()&&0!=a(this).val()||a(this).val(1)}),a(document).on("focusout",".amd-passengers-class input[name=children], .amd-passengers-class input[name=infants]",function(){""==a(this).val()&&a(this).val(0)});var s=!1;a(".amd-flight-location").each(function(){var e=a(this),n=e.closest(".amd-flight-wrapper");a(this).on("keyup",function(r){s=e,n.find(".st-location-id").remove();var i=e.attr("data-name"),o=(e.attr("data-locale"),e.val());o.length>=2&&a.getJSON("https://api.sandbox.amadeus.com/v1.2/airports/autocomplete?apikey="+st_amadeus.apikey+"&term="+o,function(s){if("object"==typeof s){var r="";r+='<select name="'+i+'" class="st-location-id st-hidden" tabindex="-1">',a.each(s,function(a,t){var e="";null!=t.label&&(e=t.label),r+='<option value="'+t.value+'">'+e+"</option>"}),r+="</select>",n.find(".st-location-id").remove(),n.append(r),r="",a("select option",n).prop("selected",!1),a("select option",n).each(function(e,s){var n=a(this).text(),i=t(n,o);i.indexOf("</span>")>=0&&(r+='<div data-text="'+n+'" data-value="'+a(this).val()+'" class="option"><span class="label"><a href="#">'+n+' <i class="fa fa-plane"></i></a></div>')}),a(".option-wrapper").html(r).show(),e.caculatePosition(a(".option-wrapper"),e)}})}),e.caculatePosition=function(){if(s&&s.length){var t=a(".option-wrapper"),e=s,r=n.offset(),i=r.top+n.height(),o=r.left,l=e.outerWidth(),d=0;d=a("#wpadminbar").length&&a(window).width()>=783?a("#wpadminbar").height():0,i-=d;var p=99999,c="absolute";a("#search-dialog").length&&(c="fixed",i=i+d-a(window).scrollTop(),p=99999),t.css({position:c,top:i,left:o,width:l,"z-index":p})}},a(window).on("resize",function(){e.caculatePosition()})}),jQuery(function(a){a(document).ready(function(){a(document).on("click","#tab-amadeus_aff_flight13 .btn-amd-search-flight",function(t){t.preventDefault();var e=a(this).closest("form"),s=!1;a("input",e).each(function(){a(this).prop("required")&&(""==a(this).val()?(s=!0,a(this).addClass("error")):a(this).removeClass("error"))}),0==a('.amd-passengers-class input[name="adults"]').val()&&0==a('.amd-passengers-class input[name="children"]').val()&&0==a('.amd-passengers-class input[name="infants"]').val()?(s=!0,a(".amd_group_display").addClass("error")):a(".amd_group_display").removeClass("error"),s||e.trigger("submit")})})})});